<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inecuaciones Lineales â€” Grado 11</title>
<style>
  :root {
    --verde: #b5e61d;
    --amarillo: #fff200;
    --verde-dark: #7aad00;
    --amarillo-dark: #c8b800;
    --bg: #f9ffe0;
    --texto: #1a2200;
    --card: #ffffcc;
    --correcto: #3a7d00;
    --incorrecto: #c0392b;
    --neutro: #555;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, var(--verde) 0%, var(--amarillo) 100%);
    min-height: 100vh;
    color: var(--texto);
  }
  header {
    background: linear-gradient(90deg, #4a7200 0%, #8ab000 50%, #4a7200 100%);
    color: #fff;
    text-align: center;
    padding: 18px 10px 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.25);
  }
  header h1 { font-size: 1.6rem; letter-spacing: 1px; }
  header p { font-size: 0.85rem; margin-top: 4px; opacity: 0.9; }
  .creditos {
    font-size: 0.75rem;
    margin-top: 8px;
    opacity: 0.85;
    font-style: italic;
  }

  /* REGISTRO */
  #pantalla-registro {
    max-width: 520px;
    margin: 40px auto;
    background: var(--card);
    border-radius: 16px;
    padding: 32px 28px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.18);
    text-align: center;
  }
  #pantalla-registro h2 { color: var(--verde-dark); margin-bottom: 18px; }
  #pantalla-registro input, #pantalla-registro select {
    width: 100%; padding: 10px 14px; margin: 8px 0 14px;
    border: 2px solid var(--verde-dark); border-radius: 8px;
    font-size: 1rem; background: #fffff0;
  }
  #pantalla-registro label { display: block; text-align: left; font-weight: 600; margin-top: 6px; }
  .btn-start {
    background: linear-gradient(90deg, var(--verde-dark), #a0d000);
    color: #fff; border: none; padding: 13px 40px;
    border-radius: 30px; font-size: 1.1rem; cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2); margin-top: 8px;
    transition: transform 0.15s;
  }
  .btn-start:hover { transform: scale(1.04); }

  /* QUIZ */
  #pantalla-quiz { display: none; max-width: 760px; margin: 24px auto; padding: 0 12px 60px; }

  .progreso-bar-wrap {
    background: rgba(255,255,255,0.5);
    border-radius: 20px; height: 12px; margin: 10px 0 18px;
    overflow: hidden;
  }
  .progreso-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--verde-dark), #d0ff00);
    border-radius: 20px;
    transition: width 0.4s;
  }
  .progreso-txt { text-align: right; font-size: 0.8rem; font-weight: 700; color: #3a5200; margin-top: -14px; margin-bottom: 14px; }

  .seccion-label {
    background: #4a7200;
    color: #fff;
    display: inline-block;
    padding: 4px 16px;
    border-radius: 20px;
    font-size: 0.78rem;
    font-weight: 700;
    letter-spacing: 0.5px;
    margin-bottom: 10px;
  }

  .card-pregunta {
    background: var(--card);
    border-radius: 16px;
    padding: 24px 26px 20px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.14);
    margin-bottom: 10px;
  }
  .num-pregunta { font-size: 0.8rem; font-weight: 700; color: var(--verde-dark); margin-bottom: 6px; }
  .enunciado { font-size: 1.05rem; font-weight: 600; line-height: 1.6; margin-bottom: 18px; }
  .enunciado .eq {
    font-family: 'Courier New', monospace;
    background: #e8ffb0;
    padding: 2px 8px;
    border-radius: 6px;
    font-size: 1.1rem;
    font-weight: 700;
  }

  .opciones { list-style: none; }
  .opciones li { margin-bottom: 10px; }
  .opciones label {
    display: flex; align-items: center; gap: 12px;
    padding: 10px 16px;
    background: #fffff5;
    border: 2px solid #c8e040;
    border-radius: 10px;
    cursor: pointer;
    font-size: 0.97rem;
    transition: background 0.15s, border-color 0.15s;
  }
  .opciones label:hover { background: #f0ffc0; border-color: var(--verde-dark); }
  .opciones input[type=radio] { width: 18px; height: 18px; accent-color: var(--verde-dark); flex-shrink: 0; }

  .opciones label.correcta { background: #d4f7a0; border-color: var(--correcto); }
  .opciones label.incorrecta { background: #ffd6d0; border-color: var(--incorrecto); }

  .feedback {
    display: none;
    margin-top: 14px;
    padding: 12px 16px;
    border-radius: 10px;
    font-size: 0.93rem;
    line-height: 1.55;
  }
  .feedback.correcto { background: #e6ffcc; border-left: 5px solid var(--correcto); color: var(--correcto); }
  .feedback.incorrecto { background: #ffe6e3; border-left: 5px solid var(--incorrecto); color: var(--incorrecto); }

  .btn-verificar, .btn-siguiente {
    border: none; border-radius: 24px; padding: 10px 32px;
    font-size: 1rem; font-weight: 700; cursor: pointer;
    margin-top: 16px; transition: transform 0.12s;
  }
  .btn-verificar { background: linear-gradient(90deg, var(--verde-dark), #b0d800); color: #fff; box-shadow: 0 3px 10px rgba(0,0,0,0.15); }
  .btn-siguiente { background: linear-gradient(90deg, #c8b800, var(--amarillo-dark)); color: #3a3000; box-shadow: 0 3px 10px rgba(0,0,0,0.15); display: none; }
  .btn-verificar:hover, .btn-siguiente:hover { transform: scale(1.04); }
  .btn-verificar:disabled { opacity: 0.45; cursor: default; transform: none; }

  /* RESULTADOS */
  #pantalla-resultados {
    display: none; max-width: 680px; margin: 30px auto;
    background: var(--card); border-radius: 20px;
    padding: 36px 30px; box-shadow: 0 8px 32px rgba(0,0,0,0.18);
    text-align: center;
  }
  .resultado-titulo { font-size: 1.8rem; font-weight: 900; color: var(--verde-dark); margin-bottom: 6px; }
  .resultado-nota { font-size: 4rem; font-weight: 900; color: #4a7200; }
  .resultado-sub { font-size: 1rem; color: #555; margin: 4px 0 20px; }
  .tabla-resultados { width: 100%; border-collapse: collapse; margin-top: 14px; font-size: 0.88rem; }
  .tabla-resultados th { background: #4a7200; color: #fff; padding: 8px 10px; }
  .tabla-resultados td { padding: 7px 10px; border-bottom: 1px solid #d8f0a0; }
  .tabla-resultados tr:nth-child(even) td { background: #f5ffdc; }
  .icono-check { color: var(--correcto); font-size: 1.1rem; }
  .icono-x { color: var(--incorrecto); font-size: 1.1rem; }
  .btn-exportar {
    background: linear-gradient(90deg, #4a7200, #8ab000);
    color: #fff; border: none; padding: 12px 36px;
    border-radius: 28px; font-size: 1rem; cursor: pointer;
    margin: 18px 8px 0; box-shadow: 0 4px 12px rgba(0,0,0,0.18);
    transition: transform 0.12s;
  }
  .btn-exportar:hover { transform: scale(1.04); }
  .btn-reiniciar {
    background: linear-gradient(90deg, #c8b800, #ffe000);
    color: #3a3000; border: none; padding: 12px 36px;
    border-radius: 28px; font-size: 1rem; cursor: pointer;
    margin: 18px 8px 0; box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    transition: transform 0.12s;
  }
  .btn-reiniciar:hover { transform: scale(1.04); }

  .insignia {
    font-size: 3.5rem; margin-bottom: 6px; display: block;
  }

  @media (max-width: 500px) {
    .card-pregunta { padding: 16px 14px; }
    .enunciado { font-size: 0.97rem; }
  }
</style>
</head>
<body>

<header>
  <h1>ğŸ“ Inecuaciones Lineales â€” CÃ¡lculo 11Â°</h1>
  <p>Cuestionario interactivo de opciÃ³n mÃºltiple</p>
  <div class="creditos">Luis Jorge MillÃ¡n Bustamante Â· Liceo Arquidiocesano de Nuestra SeÃ±ora Â· Manizales</div>
</header>

<!-- REGISTRO -->
<div id="pantalla-registro">
  <h2>ğŸ‘¤ Datos del Estudiante</h2>
  <label>Nombre completo</label>
  <input type="text" id="inp-nombre" placeholder="Ej: Juan PÃ©rez GarcÃ­a">
  <label>Curso</label>
  <input type="text" id="inp-curso" placeholder="Ej: 11-A">
  <label>Fecha</label>
  <input type="date" id="inp-fecha">
  <br>
  <button class="btn-start" onclick="iniciarQuiz()">â–¶ Iniciar cuestionario</button>
</div>

<!-- QUIZ -->
<div id="pantalla-quiz">
  <div class="progreso-bar-wrap"><div class="progreso-bar" id="bar-progreso" style="width:0%"></div></div>
  <div class="progreso-txt" id="txt-progreso">Pregunta 0 de 20</div>
  <div id="contenedor-pregunta"></div>
</div>

<!-- RESULTADOS -->
<div id="pantalla-resultados">
  <span class="insignia" id="insignia-emoji">ğŸ†</span>
  <div class="resultado-titulo">Â¡Resultados!</div>
  <div class="resultado-nota" id="nota-display">0.0</div>
  <div class="resultado-sub" id="puntaje-display">0 / 20 correctas</div>
  <div id="nombre-display" style="font-weight:700;color:#4a7200;margin-bottom:14px;"></div>
  <table class="tabla-resultados" id="tabla-res">
    <thead><tr><th>#</th><th>SecciÃ³n</th><th>Resultado</th><th>Correcta</th></tr></thead>
    <tbody id="tbody-res"></tbody>
  </table>
  <br>
  <button class="btn-exportar" onclick="exportarCSV()">ğŸ“¥ Exportar resultados (CSV)</button>
  <button class="btn-reiniciar" onclick="reiniciar()">ğŸ”„ Nuevo intento</button>
</div>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// BANCO DE PREGUNTAS (20 preguntas)
// Letra correcta por pregunta:
// P1â†’A, P2â†’D, P3â†’B, P4â†’C, P5â†’A
// P6â†’D, P7â†’B, P8â†’C, P9â†’A, P10â†’D
// P11â†’B, P12â†’C, P13â†’A, P14â†’D, P15â†’B
// P16â†’C, P17â†’A, P18â†’D, P19â†’B, P20â†’C
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PREGUNTAS = [
  // â”€â”€ SECCIÃ“N 1: ax + b  |  Nivel intermedio-superior â”€â”€
  {
    seccion: "SecciÃ³n 1 â€” Inecuaciones ax + b  Â·  Nivel intermedio",
    enunciado: "Resuelve la inecuaciÃ³n: <span class='eq'>(3/2)x âˆ’ 9 > 0</span>",
    opciones: ["x > 6", "x > 3", "x < 6", "x > 9"],
    correcta: 0, // A
    feedback: "Sumamos 9: (3/2)x > 9. Multiplicamos ambos lados por 2/3 (positivo, no cambia el signo): x > 6. Respuesta: A."
  },
  {
    seccion: "SecciÃ³n 1 â€” Inecuaciones ax + b  Â·  Nivel intermedio",
    enunciado: "Resuelve la inecuaciÃ³n: <span class='eq'>âˆ’(3/4)x + 9 â‰¤ 0</span>",
    opciones: ["x â‰¤ 12", "x â‰¥ âˆ’12", "x â‰¤ âˆ’12", "x â‰¥ 12"],
    correcta: 3, // D
    feedback: "Restamos 9: âˆ’(3/4)x â‰¤ âˆ’9. Multiplicamos por âˆ’4/3 (negativo, cambia el signo): x â‰¥ 12. Respuesta: D."
  },
  {
    seccion: "SecciÃ³n 1 â€” Inecuaciones ax + b  Â·  Nivel intermedio",
    enunciado: "Resuelve la inecuaciÃ³n: <span class='eq'>(2/3)x + 4 < âˆ’2</span>",
    opciones: ["x < âˆ’3", "x < âˆ’9", "x > âˆ’9", "x < 9"],
    correcta: 1, // B
    feedback: "Restamos 4: (2/3)x < âˆ’6. Multiplicamos por 3/2 (positivo): x < âˆ’9. Respuesta: B."
  },
  {
    seccion: "SecciÃ³n 1 â€” Inecuaciones ax + b  Â·  Nivel superior",
    enunciado: "Resuelve la inecuaciÃ³n con variables en ambos miembros: <span class='eq'>âˆ’5x + 3 â‰¥ 2x âˆ’ 11</span>",
    opciones: ["x â‰¥ 2", "x â‰¤ âˆ’2", "x â‰¤ 2", "x â‰¥ âˆ’2"],
    correcta: 2, // C
    feedback: "Pasamos tÃ©rminos: 3 + 11 â‰¥ 2x + 5x â†’ 14 â‰¥ 7x â†’ x â‰¤ 2. Dividimos entre 7 (positivo). Respuesta: C."
  },
  {
    seccion: "SecciÃ³n 1 â€” Inecuaciones ax + b  Â·  Nivel superior",
    enunciado: "Resuelve la inecuaciÃ³n con parÃ©ntesis: <span class='eq'>3(2x âˆ’ 1) âˆ’ 4x > 5</span>",
    opciones: ["x > 4", "x < 4", "x > 2", "x > 8"],
    correcta: 0, // A
    feedback: "Distribuimos: 6x âˆ’ 3 âˆ’ 4x > 5 â†’ 2x > 8 â†’ x > 4. Dividimos entre 2 (positivo). Respuesta: A."
  },

  // â”€â”€ SECCIÃ“N 2: a < bx+c < d  |  Nivel superior â”€â”€
  {
    seccion: "SecciÃ³n 2 â€” Inecuaciones a &lt; bx+c &lt; d  Â·  Nivel superior",
    enunciado: "Resuelve la inecuaciÃ³n con coeficiente fraccionario: <span class='eq'>âˆ’3 &lt; (x + 5)/2 â‰¤ 4</span>",
    opciones: ["âˆ’1 < x â‰¤ 3", "âˆ’8 < x â‰¤ 3", "âˆ’16 < x â‰¤ 3", "âˆ’11 < x â‰¤ 3"],
    correcta: 3, // D
    feedback: "Multiplicamos por 2 (positivo): âˆ’6 < x + 5 â‰¤ 8. Restamos 5: âˆ’11 < x â‰¤ 3. Respuesta: D."
  },
  {
    seccion: "SecciÃ³n 2 â€” Inecuaciones a &lt; bx+c &lt; d  Â·  Nivel superior",
    enunciado: "Resuelve: <span class='eq'>1 â‰¤ (2 âˆ’ 3x)/4 &lt; 3</span>",
    opciones: ["âˆ’10/3 &lt; x â‰¤ âˆ’2/3", "2/3 â‰¤ x &lt; 10/3", "âˆ’2 &lt; x â‰¤ 2/3", "âˆ’3 â‰¤ x &lt; 1/3"],
    correcta: 1, // B
    feedback: "Multiplicamos por 4: 4 â‰¤ 2 âˆ’ 3x < 12. Restamos 2: 2 â‰¤ âˆ’3x < 10. Dividimos entre âˆ’3 (negativo, cambian los signos): âˆ’10/3 < x â‰¤ âˆ’2/3. Respuesta: B."
  },
  {
    seccion: "SecciÃ³n 2 â€” Inecuaciones a &lt; bx+c &lt; d  Â·  Nivel superior",
    enunciado: "Resuelve: <span class='eq'>âˆ’7 &lt; 3 âˆ’ 2x â‰¤ 9</span>",
    opciones: ["âˆ’3 &lt; x â‰¤ 5", "âˆ’5 &lt; x â‰¤ 3", "âˆ’3 â‰¤ x &lt; 5", "3 â‰¤ x &lt; 5"],
    correcta: 2, // C
    feedback: "Restamos 3: âˆ’10 < âˆ’2x â‰¤ 6. Dividimos entre âˆ’2 (negativo, cambian los signos): âˆ’3 â‰¤ x < 5. Respuesta: C."
  },
  {
    seccion: "SecciÃ³n 2 â€” Inecuaciones a &lt; bx+c &lt; d  Â·  Nivel superior",
    enunciado: "Resuelve: <span class='eq'>5 â‰¤ 4 âˆ’ (x/3) &lt; 8</span>",
    opciones: ["âˆ’12 &lt; x â‰¤ âˆ’3", "3 â‰¤ x &lt; 12", "âˆ’3 &lt; x â‰¤ 12", "âˆ’4 â‰¤ x &lt; 3"],
    correcta: 0, // A
    feedback: "Restamos 4: 1 â‰¤ âˆ’x/3 < 4. Multiplicamos por âˆ’3 (negativo, cambian los signos): âˆ’12 < x â‰¤ âˆ’3. Respuesta: A."
  },
  {
    seccion: "SecciÃ³n 2 â€” Inecuaciones a &lt; bx+c &lt; d  Â·  Nivel superior",
    enunciado: "Resuelve: <span class='eq'>âˆ’2 &lt; (5x âˆ’ 3)/4 â‰¤ 3</span>",
    opciones: ["âˆ’1 &lt; x â‰¤ 4", "0 &lt; x â‰¤ 3", "âˆ’5/4 &lt; x â‰¤ 3", "âˆ’1 &lt; x â‰¤ 3"],
    correcta: 3, // D
    feedback: "Multiplicamos por 4: âˆ’8 < 5x âˆ’ 3 â‰¤ 12. Sumamos 3: âˆ’5 < 5x â‰¤ 15. Dividimos entre 5: âˆ’1 < x â‰¤ 3. Respuesta: D."
  },

  // â”€â”€ SECCIÃ“N 3: Aplicaciones en ingenierÃ­a y ciencias  |  Nivel superior â”€â”€
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones  Â·  Electricidad",
    enunciado: "Por la ley de Ohm V = IR, la tensiÃ³n V (V) en un circuito con resistencia R = 4 Î© debe satisfacer <span class='eq'>12 â‰¤ 4I â‰¤ 60</span>. Â¿En quÃ© rango debe estar la corriente I (A)?",
    opciones: ["1 â‰¤ I â‰¤ 15", "3 â‰¤ I â‰¤ 15", "3 â‰¤ I â‰¤ 16", "4 â‰¤ I â‰¤ 15"],
    correcta: 1, // B
    feedback: "Dividimos toda la inecuaciÃ³n entre 4 (positivo): 3 â‰¤ I â‰¤ 15. La corriente debe estar entre 3 A y 15 A. Respuesta: B."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones  Â·  QuÃ­mica",
    enunciado: "La tasa de degradaciÃ³n de un compuesto orgÃ¡nico sigue el modelo <span class='eq'>âˆ’(1/3)C + 8 â‰¥ 2</span>, donde C es la concentraciÃ³n (mg/L). Â¿Para quÃ© valores de C se cumple la condiciÃ³n?",
    opciones: ["C â‰¥ 18", "C â‰¤ 6", "C â‰¤ 18", "C â‰¥ 6"],
    correcta: 2, // C
    feedback: "Restamos 8: âˆ’(1/3)C â‰¥ âˆ’6. Multiplicamos por âˆ’3 (negativo, cambia el signo): C â‰¤ 18. La concentraciÃ³n no debe superar 18 mg/L. Respuesta: C."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones  Â·  CinemÃ¡tica",
    enunciado: "La posiciÃ³n de una partÃ­cula en movimiento rectilÃ­neo es <span class='eq'>x(t) = 3t âˆ’ 6</span> metros. Â¿A partir de quÃ© instante t (s) la partÃ­cula estÃ¡ en posiciÃ³n positiva, es decir x(t) > 0?",
    opciones: ["t > 2 s", "t > 3 s", "t > 6 s", "t > 1/2 s"],
    correcta: 0, // A
    feedback: "Resolvemos 3t âˆ’ 6 > 0 â†’ 3t > 6 â†’ t > 2. La partÃ­cula ocupa posiciÃ³n positiva para t > 2 s. Respuesta: A."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones  Â·  IngenierÃ­a de fluidos",
    enunciado: "La presiÃ³n P (kPa) en una tuberÃ­a debe cumplir <span class='eq'>15 â‰¤ (2P + 6)/3 â‰¤ 25</span>. Â¿En quÃ© intervalo debe mantenerse P?",
    opciones: ["20 â‰¤ P â‰¤ 37", "21/2 â‰¤ P â‰¤ 37/2", "15 â‰¤ P â‰¤ 35", "39/2 â‰¤ P â‰¤ 69/2"],
    correcta: 3, // D
    feedback: "Multiplicamos por 3: 45 â‰¤ 2P + 6 â‰¤ 75. Restamos 6: 39 â‰¤ 2P â‰¤ 69. Dividimos entre 2: 39/2 â‰¤ P â‰¤ 69/2. Respuesta: D."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones  Â·  BiologÃ­a",
    enunciado: "Un cultivo bacteriano es viable cuando su pH satisface <span class='eq'>âˆ’3 â‰¤ 3(pH) âˆ’ 18 â‰¤ 3</span>. Â¿En quÃ© intervalo debe estar el pH?",
    opciones: ["4 â‰¤ pH â‰¤ 8", "5 â‰¤ pH â‰¤ 7", "6 â‰¤ pH â‰¤ 8", "4 â‰¤ pH â‰¤ 6"],
    correcta: 1, // B
    feedback: "Sumamos 18: 15 â‰¤ 3Â·pH â‰¤ 21. Dividimos entre 3: 5 â‰¤ pH â‰¤ 7. El cultivo es viable en pH entre 5 y 7. Respuesta: B."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones  Â·  ElectrÃ³nica",
    enunciado: "Dos resistores en serie disipan potencia segÃºn las expresiones <span class='eq'>3R âˆ’ 5 &lt; 2R + 7</span> (en vatios), donde R es la resistencia (Î©). Â¿Para quÃ© valores de R se cumple la condiciÃ³n de operaciÃ³n segura?",
    opciones: ["R > 12", "R < 2", "R &lt; 12", "R â‰¥ 12"],
    correcta: 2, // C
    feedback: "Pasamos 2R al primer miembro y âˆ’5 al segundo: 3R âˆ’ 2R < 7 + 5 â†’ R < 12. La resistencia debe ser menor que 12 Î©. Respuesta: C."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones  Â·  EconomÃ­a de ingenierÃ­a",
    enunciado: "El costo total de producciÃ³n de n unidades de un componente electrÃ³nico es C = 500 + 80n (pesos Ã— 10Â³). Para no superar el presupuesto de $2 100 000, se debe cumplir <span class='eq'>500 + 80n â‰¤ 2100</span>. Â¿CuÃ¡ntas unidades como mÃ¡ximo se pueden producir?",
    opciones: ["n â‰¤ 20", "n â‰¤ 25", "n â‰¤ 32", "n â‰¤ 15"],
    correcta: 0, // A
    feedback: "Restamos 500: 80n â‰¤ 1600. Dividimos entre 80: n â‰¤ 20. Se pueden producir mÃ¡ximo 20 unidades. Respuesta: A."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones  Â·  HidrÃ¡ulica",
    enunciado: "El caudal Q (mÂ³/s) en una tuberÃ­a de riego debe satisfacer <span class='eq'>4 &lt; (3Q âˆ’ 2)/5 â‰¤ 8</span>. Â¿En quÃ© intervalo debe estar Q?",
    opciones: ["22/3 &lt; Q â‰¤ 15", "6 &lt; Q â‰¤ 14", "2 &lt; Q â‰¤ 8", "22/3 &lt; Q â‰¤ 14"],
    correcta: 3, // D
    feedback: "Multiplicamos por 5: 20 < 3Q âˆ’ 2 â‰¤ 40. Sumamos 2: 22 < 3Q â‰¤ 42. Dividimos entre 3: 22/3 < Q â‰¤ 14. Respuesta: D."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones  Â·  Procesamiento de seÃ±ales",
    enunciado: "El retardo t (ms) de una seÃ±al en una red satisface <span class='eq'>âˆ’6 &lt; 4 âˆ’ 5t â‰¤ 14</span>. Â¿En quÃ© intervalo se encuentra t?",
    opciones: ["âˆ’2 &lt; t â‰¤ 2", "âˆ’2 â‰¤ t &lt; 2", "0 &lt; t â‰¤ 2", "âˆ’2 &lt; t &lt; 2"],
    correcta: 1, // B
    feedback: "Restamos 4: âˆ’10 < âˆ’5t â‰¤ 10. Dividimos entre âˆ’5 (negativo, cambian los signos): âˆ’2 â‰¤ t < 2. Respuesta: B."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones  Â·  MecÃ¡nica de materiales",
    enunciado: "El esfuerzo Ïƒ (MPa) en una viga de acero debe satisfacer <span class='eq'>(2Ïƒ + 10)/3 âˆ’ Ïƒ â‰¥ 1</span> para garantizar que no hay falla. Â¿Para quÃ© valores de Ïƒ se cumple esto?",
    opciones: ["Ïƒ â‰¥ 7", "Ïƒ â‰¤ âˆ’7", "Ïƒ â‰¤ 7", "Ïƒ â‰¥ âˆ’7"],
    correcta: 2, // C
    feedback: "Multiplicamos por 3: 2Ïƒ + 10 âˆ’ 3Ïƒ â‰¥ 3 â†’ âˆ’Ïƒ â‰¥ âˆ’7 â†’ Ïƒ â‰¤ 7. Dividimos entre âˆ’1 (cambia el signo). La condiciÃ³n se cumple para Ïƒ â‰¤ 7 MPa. Respuesta: C."
  },
];

// CorrecciÃ³n manual de las respuestas (Ã­ndice 0=A, 1=B, 2=C, 3=D):
// P1(idx0)â†’A=0, P2â†’D=3, P3â†’B=1, P4â†’C=2, P5â†’A=0
// P6â†’D=3, P7â†’B=1, P8â†’C=2, P9â†’A=0, P10â†’D=3
// P11â†’B=1, P12â†’C=2, P13â†’A=0, P14â†’D=3, P15â†’B=1
// P16â†’C=2, P17â†’A=0, P18â†’D=3, P19â†’B=1, P20â†’C=2
const CORRECTAS_OVERRIDE = [0,3,1,2,0, 3,1,2,0,3, 1,2,0,3,1, 2,0,3,1,2];

let estudiante = {};
let preguntaActual = 0;
let respuestas = [];
let respondida = false;

function iniciarQuiz() {
  const nombre = document.getElementById('inp-nombre').value.trim();
  const curso = document.getElementById('inp-curso').value.trim();
  const fecha = document.getElementById('inp-fecha').value;
  if (!nombre || !curso) { alert('Por favor ingresa tu nombre y curso.'); return; }
  estudiante = { nombre, curso, fecha: fecha || new Date().toLocaleDateString('es-CO') };
  document.getElementById('pantalla-registro').style.display = 'none';
  document.getElementById('pantalla-quiz').style.display = 'block';
  mostrarPregunta();
}

function mostrarPregunta() {
  respondida = false;
  const p = PREGUNTAS[preguntaActual];
  const correcta = CORRECTAS_OVERRIDE[preguntaActual];
  const letras = ['A', 'B', 'C', 'D'];
  const total = PREGUNTAS.length;
  const pct = Math.round((preguntaActual / total) * 100);
  document.getElementById('bar-progreso').style.width = pct + '%';
  document.getElementById('txt-progreso').textContent = `Pregunta ${preguntaActual + 1} de ${total}`;

  let opcionesHTML = '';
  p.opciones.forEach((op, i) => {
    opcionesHTML += `
      <li>
        <label id="lbl-op-${i}">
          <input type="radio" name="opcion" value="${i}" onchange="seleccionarOpcion()">
          <strong>${letras[i]}.</strong> ${op}
        </label>
      </li>`;
  });

  document.getElementById('contenedor-pregunta').innerHTML = `
    <div class="seccion-label">${p.seccion}</div>
    <div class="card-pregunta">
      <div class="num-pregunta">Pregunta ${preguntaActual + 1} de ${total}</div>
      <div class="enunciado">${p.enunciado}</div>
      <ul class="opciones">${opcionesHTML}</ul>
      <div class="feedback" id="feedback-box"></div>
      <button class="btn-verificar" id="btn-ver" onclick="verificar()" disabled>âœ” Verificar</button>
      <button class="btn-siguiente" id="btn-sig" onclick="siguiente()">
        ${preguntaActual < total - 1 ? 'Siguiente âœ' : 'Ver resultados ğŸ'}
      </button>
    </div>`;
}

function seleccionarOpcion() {
  if (!respondida) document.getElementById('btn-ver').disabled = false;
}

function verificar() {
  if (respondida) return;
  respondida = true;
  const seleccionada = document.querySelector('input[name="opcion"]:checked');
  if (!seleccionada) return;
  const idx = parseInt(seleccionada.value);
  const correcta = CORRECTAS_OVERRIDE[preguntaActual];
  const p = PREGUNTAS[preguntaActual];
  const letras = ['A', 'B', 'C', 'D'];

  respuestas.push({ pregunta: preguntaActual + 1, seccion: p.seccion, seleccionada: idx, correcta, ok: idx === correcta });

  // Colorear opciones
  document.querySelectorAll('input[name="opcion"]').forEach(r => r.disabled = true);
  document.getElementById(`lbl-op-${correcta}`).classList.add('correcta');
  if (idx !== correcta) document.getElementById(`lbl-op-${idx}`).classList.add('incorrecta');

  const fb = document.getElementById('feedback-box');
  fb.style.display = 'block';
  fb.className = 'feedback ' + (idx === correcta ? 'correcto' : 'incorrecto');
  fb.innerHTML = (idx === correcta ? 'âœ… Â¡Correcto! ' : `âŒ Incorrecto. La respuesta correcta es <strong>${letras[correcta]}</strong>. `) + p.feedback;

  document.getElementById('btn-ver').style.display = 'none';
  document.getElementById('btn-sig').style.display = 'inline-block';
}

function siguiente() {
  preguntaActual++;
  if (preguntaActual >= PREGUNTAS.length) {
    mostrarResultados();
  } else {
    mostrarPregunta();
  }
}

function mostrarResultados() {
  document.getElementById('pantalla-quiz').style.display = 'none';
  const pantalla = document.getElementById('pantalla-resultados');
  pantalla.style.display = 'block';

  const correctas = respuestas.filter(r => r.ok).length;
  const total = PREGUNTAS.length;
  const nota = ((correctas / total) * 5).toFixed(1);

  document.getElementById('nota-display').textContent = nota;
  document.getElementById('puntaje-display').textContent = `${correctas} de ${total} correctas`;
  document.getElementById('nombre-display').textContent = `${estudiante.nombre} Â· ${estudiante.curso} Â· ${estudiante.fecha}`;

  let emoji = 'ğŸ˜”';
  if (nota >= 4.5) emoji = 'ğŸ†';
  else if (nota >= 4.0) emoji = 'ğŸ¥‡';
  else if (nota >= 3.5) emoji = 'ğŸ¥ˆ';
  else if (nota >= 3.0) emoji = 'ğŸ¯';
  else if (nota >= 2.5) emoji = 'ğŸ“š';
  document.getElementById('insignia-emoji').textContent = emoji;

  const letras = ['A', 'B', 'C', 'D'];
  const tbody = document.getElementById('tbody-res');
  tbody.innerHTML = '';
  respuestas.forEach(r => {
    tbody.innerHTML += `<tr>
      <td>${r.pregunta}</td>
      <td style="font-size:0.8rem">${r.seccion.replace('SecciÃ³n','S.')}</td>
      <td>${r.ok ? '<span class="icono-check">âœ…</span>' : '<span class="icono-x">âŒ</span>'}</td>
      <td>${letras[r.correcta]}</td>
    </tr>`;
  });
}

function exportarCSV() {
  const letras = ['A', 'B', 'C', 'D'];
  let csv = 'Nombre,Curso,Fecha,Pregunta,Seccion,Respuesta Dada,Respuesta Correcta,Resultado\n';
  respuestas.forEach(r => {
    csv += `"${estudiante.nombre}","${estudiante.curso}","${estudiante.fecha}",${r.pregunta},"${r.seccion}",${letras[r.seleccionada]},${letras[r.correcta]},${r.ok ? 'Correcto' : 'Incorrecto'}\n`;
  });
  const correctas = respuestas.filter(r => r.ok).length;
  const nota = ((correctas / PREGUNTAS.length) * 5).toFixed(1);
  csv += `\n"Resumen","Correctas: ${correctas}/${PREGUNTAS.length}","Nota: ${nota}"\n`;

  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `resultados_${estudiante.nombre.replace(/ /g,'_')}_inecuaciones.csv`;
  a.click();
  URL.revokeObjectURL(url);
}

function reiniciar() {
  preguntaActual = 0;
  respuestas = [];
  document.getElementById('pantalla-resultados').style.display = 'none';
  document.getElementById('pantalla-registro').style.display = 'block';
}

// Set today's date by default
document.getElementById('inp-fecha').valueAsDate = new Date();
</script>
</body>
</html>
