<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inecuaciones Lineales â€” Grado 11</title>
<style>
  :root {
    --verde: #b5e61d;
    --amarillo: #fff200;
    --verde-dark: #7aad00;
    --amarillo-dark: #c8b800;
    --bg: #f9ffe0;
    --texto: #1a2200;
    --card: #ffffcc;
    --correcto: #3a7d00;
    --incorrecto: #c0392b;
    --neutro: #555;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, var(--verde) 0%, var(--amarillo) 100%);
    min-height: 100vh;
    color: var(--texto);
  }
  header {
    background: linear-gradient(90deg, #4a7200 0%, #8ab000 50%, #4a7200 100%);
    color: #fff;
    text-align: center;
    padding: 18px 10px 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.25);
  }
  header h1 { font-size: 1.6rem; letter-spacing: 1px; }
  header p { font-size: 0.85rem; margin-top: 4px; opacity: 0.9; }
  .creditos {
    font-size: 0.75rem;
    margin-top: 8px;
    opacity: 0.85;
    font-style: italic;
  }

  /* REGISTRO */
  #pantalla-registro {
    max-width: 520px;
    margin: 40px auto;
    background: var(--card);
    border-radius: 16px;
    padding: 32px 28px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.18);
    text-align: center;
  }
  #pantalla-registro h2 { color: var(--verde-dark); margin-bottom: 18px; }
  #pantalla-registro input, #pantalla-registro select {
    width: 100%; padding: 10px 14px; margin: 8px 0 14px;
    border: 2px solid var(--verde-dark); border-radius: 8px;
    font-size: 1rem; background: #fffff0;
  }
  #pantalla-registro label { display: block; text-align: left; font-weight: 600; margin-top: 6px; }
  .btn-start {
    background: linear-gradient(90deg, var(--verde-dark), #a0d000);
    color: #fff; border: none; padding: 13px 40px;
    border-radius: 30px; font-size: 1.1rem; cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2); margin-top: 8px;
    transition: transform 0.15s;
  }
  .btn-start:hover { transform: scale(1.04); }

  /* QUIZ */
  #pantalla-quiz { display: none; max-width: 760px; margin: 24px auto; padding: 0 12px 60px; }

  .progreso-bar-wrap {
    background: rgba(255,255,255,0.5);
    border-radius: 20px; height: 12px; margin: 10px 0 18px;
    overflow: hidden;
  }
  .progreso-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--verde-dark), #d0ff00);
    border-radius: 20px;
    transition: width 0.4s;
  }
  .progreso-txt { text-align: right; font-size: 0.8rem; font-weight: 700; color: #3a5200; margin-top: -14px; margin-bottom: 14px; }

  .seccion-label {
    background: #4a7200;
    color: #fff;
    display: inline-block;
    padding: 4px 16px;
    border-radius: 20px;
    font-size: 0.78rem;
    font-weight: 700;
    letter-spacing: 0.5px;
    margin-bottom: 10px;
  }

  .card-pregunta {
    background: var(--card);
    border-radius: 16px;
    padding: 24px 26px 20px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.14);
    margin-bottom: 10px;
  }
  .num-pregunta { font-size: 0.8rem; font-weight: 700; color: var(--verde-dark); margin-bottom: 6px; }
  .enunciado { font-size: 1.05rem; font-weight: 600; line-height: 1.6; margin-bottom: 18px; }
  .enunciado .eq {
    font-family: 'Courier New', monospace;
    background: #e8ffb0;
    padding: 2px 8px;
    border-radius: 6px;
    font-size: 1.1rem;
    font-weight: 700;
  }

  .opciones { list-style: none; }
  .opciones li { margin-bottom: 10px; }
  .opciones label {
    display: flex; align-items: center; gap: 12px;
    padding: 10px 16px;
    background: #fffff5;
    border: 2px solid #c8e040;
    border-radius: 10px;
    cursor: pointer;
    font-size: 0.97rem;
    transition: background 0.15s, border-color 0.15s;
  }
  .opciones label:hover { background: #f0ffc0; border-color: var(--verde-dark); }
  .opciones input[type=radio] { width: 18px; height: 18px; accent-color: var(--verde-dark); flex-shrink: 0; }

  .opciones label.correcta { background: #d4f7a0; border-color: var(--correcto); }
  .opciones label.incorrecta { background: #ffd6d0; border-color: var(--incorrecto); }

  .feedback {
    display: none;
    margin-top: 14px;
    padding: 12px 16px;
    border-radius: 10px;
    font-size: 0.93rem;
    line-height: 1.55;
  }
  .feedback.correcto { background: #e6ffcc; border-left: 5px solid var(--correcto); color: var(--correcto); }
  .feedback.incorrecto { background: #ffe6e3; border-left: 5px solid var(--incorrecto); color: var(--incorrecto); }

  .btn-verificar, .btn-siguiente {
    border: none; border-radius: 24px; padding: 10px 32px;
    font-size: 1rem; font-weight: 700; cursor: pointer;
    margin-top: 16px; transition: transform 0.12s;
  }
  .btn-verificar { background: linear-gradient(90deg, var(--verde-dark), #b0d800); color: #fff; box-shadow: 0 3px 10px rgba(0,0,0,0.15); }
  .btn-siguiente { background: linear-gradient(90deg, #c8b800, var(--amarillo-dark)); color: #3a3000; box-shadow: 0 3px 10px rgba(0,0,0,0.15); display: none; }
  .btn-verificar:hover, .btn-siguiente:hover { transform: scale(1.04); }
  .btn-verificar:disabled { opacity: 0.45; cursor: default; transform: none; }

  /* RESULTADOS */
  #pantalla-resultados {
    display: none; max-width: 680px; margin: 30px auto;
    background: var(--card); border-radius: 20px;
    padding: 36px 30px; box-shadow: 0 8px 32px rgba(0,0,0,0.18);
    text-align: center;
  }
  .resultado-titulo { font-size: 1.8rem; font-weight: 900; color: var(--verde-dark); margin-bottom: 6px; }
  .resultado-nota { font-size: 4rem; font-weight: 900; color: #4a7200; }
  .resultado-sub { font-size: 1rem; color: #555; margin: 4px 0 20px; }
  .tabla-resultados { width: 100%; border-collapse: collapse; margin-top: 14px; font-size: 0.88rem; }
  .tabla-resultados th { background: #4a7200; color: #fff; padding: 8px 10px; }
  .tabla-resultados td { padding: 7px 10px; border-bottom: 1px solid #d8f0a0; }
  .tabla-resultados tr:nth-child(even) td { background: #f5ffdc; }
  .icono-check { color: var(--correcto); font-size: 1.1rem; }
  .icono-x { color: var(--incorrecto); font-size: 1.1rem; }
  .btn-exportar {
    background: linear-gradient(90deg, #4a7200, #8ab000);
    color: #fff; border: none; padding: 12px 36px;
    border-radius: 28px; font-size: 1rem; cursor: pointer;
    margin: 18px 8px 0; box-shadow: 0 4px 12px rgba(0,0,0,0.18);
    transition: transform 0.12s;
  }
  .btn-exportar:hover { transform: scale(1.04); }
  .btn-reiniciar {
    background: linear-gradient(90deg, #c8b800, #ffe000);
    color: #3a3000; border: none; padding: 12px 36px;
    border-radius: 28px; font-size: 1rem; cursor: pointer;
    margin: 18px 8px 0; box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    transition: transform 0.12s;
  }
  .btn-reiniciar:hover { transform: scale(1.04); }

  .insignia {
    font-size: 3.5rem; margin-bottom: 6px; display: block;
  }

  @media (max-width: 500px) {
    .card-pregunta { padding: 16px 14px; }
    .enunciado { font-size: 0.97rem; }
  }
</style>
</head>
<body>

<header>
  <h1>ğŸ“ Inecuaciones Lineales â€” CÃ¡lculo 11Â°</h1>
  <p>Cuestionario interactivo de opciÃ³n mÃºltiple</p>
  <div class="creditos">Luis Jorge MillÃ¡n Bustamante Â· Liceo Arquidiocesano de Nuestra SeÃ±ora Â· Manizales</div>
</header>

<!-- REGISTRO -->
<div id="pantalla-registro">
  <h2>ğŸ‘¤ Datos del Estudiante</h2>
  <label>Nombre completo</label>
  <input type="text" id="inp-nombre" placeholder="Ej: Juan PÃ©rez GarcÃ­a">
  <label>Curso</label>
  <input type="text" id="inp-curso" placeholder="Ej: 11-A">
  <label>Fecha</label>
  <input type="date" id="inp-fecha">
  <br>
  <button class="btn-start" onclick="iniciarQuiz()">â–¶ Iniciar cuestionario</button>
</div>

<!-- QUIZ -->
<div id="pantalla-quiz">
  <div class="progreso-bar-wrap"><div class="progreso-bar" id="bar-progreso" style="width:0%"></div></div>
  <div class="progreso-txt" id="txt-progreso">Pregunta 0 de 20</div>
  <div id="contenedor-pregunta"></div>
</div>

<!-- RESULTADOS -->
<div id="pantalla-resultados">
  <span class="insignia" id="insignia-emoji">ğŸ†</span>
  <div class="resultado-titulo">Â¡Resultados!</div>
  <div class="resultado-nota" id="nota-display">0.0</div>
  <div class="resultado-sub" id="puntaje-display">0 / 20 correctas</div>
  <div id="nombre-display" style="font-weight:700;color:#4a7200;margin-bottom:14px;"></div>
  <table class="tabla-resultados" id="tabla-res">
    <thead><tr><th>#</th><th>SecciÃ³n</th><th>Resultado</th><th>Correcta</th></tr></thead>
    <tbody id="tbody-res"></tbody>
  </table>
  <br>
  <button class="btn-exportar" onclick="exportarCSV()">ğŸ“¥ Exportar resultados (CSV)</button>
  <button class="btn-reiniciar" onclick="reiniciar()">ğŸ”„ Nuevo intento</button>
</div>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// BANCO DE PREGUNTAS (20 preguntas)
// correcta: Ã­ndice 0-3 (A,B,C,D)
// La letra correcta varÃ­a segÃºn enunciado:
// P1â†’A, P2â†’D, P3â†’B, P4â†’C, P5â†’A,
// P6â†’D, P7â†’B, P8â†’C, P9â†’A, P10â†’D,
// P11â†’B, P12â†’C, P13â†’A, P14â†’D, P15â†’B,
// P16â†’C, P17â†’A, P18â†’D, P19â†’B, P20â†’C
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PREGUNTAS = [
  // â”€â”€ SECCIÃ“N 1: ax + b (5 preguntas) â”€â”€
  {
    seccion: "SecciÃ³n 1 â€” Inecuaciones ax + b",
    enunciado: "Resuelve la inecuaciÃ³n: <span class='eq'>3x âˆ’ 9 â‰¥ 0</span>",
    opciones: ["x â‰¥ 3", "x â‰¤ 3", "x â‰¥ âˆ’3", "x â‰¤ âˆ’3"],
    correcta: 0, // A
    feedback: "Sumamos 9: 3x â‰¥ 9. Dividimos entre 3 (positivo, no cambia el signo): x â‰¥ 3. Respuesta: A."
  },
  {
    seccion: "SecciÃ³n 1 â€” Inecuaciones ax + b",
    enunciado: "Resuelve la inecuaciÃ³n: <span class='eq'>âˆ’2x + 6 > 0</span>",
    opciones: ["x > 3", "x < âˆ’3", "x > âˆ’3", "x < 3"],
    correcta: 3, // D
    feedback: "Restamos 6: âˆ’2x > âˆ’6. Dividimos entre âˆ’2 (negativo: cambia el signo â‰» â‰º): x < 3. Respuesta: D."
  },
  {
    seccion: "SecciÃ³n 1 â€” Inecuaciones ax + b",
    enunciado: "Resuelve la inecuaciÃ³n: <span class='eq'>5x + 15 â‰¤ 0</span>",
    opciones: ["x â‰¤ 3", "x â‰¤ âˆ’3", "x â‰¥ âˆ’3", "x â‰¥ 3"],
    correcta: 1, // B
    feedback: "Restamos 15: 5x â‰¤ âˆ’15. Dividimos entre 5 (positivo): x â‰¤ âˆ’3. Respuesta: B."
  },
  {
    seccion: "SecciÃ³n 1 â€” Inecuaciones ax + b",
    enunciado: "Resuelve la inecuaciÃ³n: <span class='eq'>4x âˆ’ 8 < 0</span>",
    opciones: ["x < âˆ’2", "x > 2", "x < 2", "x < 2"],
    opciones: ["x < âˆ’2", "x > 2", "x > âˆ’2", "x < 2"],
    correcta: 2, // C (Ã­ndice 2)
    feedback: "Sumamos 8: 4x < 8. Dividimos entre 4: x < 2. Respuesta: C (x < 2)."
  },
  {
    seccion: "SecciÃ³n 1 â€” Inecuaciones ax + b",
    enunciado: "Resuelve la inecuaciÃ³n: <span class='eq'>âˆ’7x + 14 â‰¥ 0</span>",
    opciones: ["x â‰¤ 2", "x â‰¥ 2", "x â‰¤ âˆ’2", "x â‰¥ âˆ’2"],
    correcta: 0, // A
    feedback: "Restamos 14: âˆ’7x â‰¥ âˆ’14. Dividimos entre âˆ’7 (negativo, cambia signo): x â‰¤ 2. Respuesta: A."
  },

  // â”€â”€ SECCIÃ“N 2: a < bx + c < d (5 preguntas) â”€â”€
  {
    seccion: "SecciÃ³n 2 â€” Inecuaciones a < bx + c < d",
    enunciado: "Resuelve la inecuaciÃ³n compuesta: <span class='eq'>1 < 2x âˆ’ 3 < 7</span>",
    opciones: ["0 < x < 5", "2 < x < 5", "âˆ’2 < x < 2", "1 < x < 5"],
    correcta: 3, // D
    feedback: "Sumamos 3 en toda la inecuaciÃ³n: 4 < 2x < 10. Dividimos entre 2: 2 < x < 5. Respuesta: D."
  },
  {
    seccion: "SecciÃ³n 2 â€” Inecuaciones a < bx + c < d",
    enunciado: "Resuelve: <span class='eq'>âˆ’5 â‰¤ 3x + 1 â‰¤ 10</span>",
    opciones: ["âˆ’2 â‰¤ x â‰¤ 3", "2 â‰¤ x â‰¤ 3", "âˆ’3 â‰¤ x â‰¤ 3", "0 â‰¤ x â‰¤ 3"],
    correcta: 1, // B (Ã­ndice 1 â†’ âˆ’2 â‰¤ x â‰¤ 3)
    feedback: "Restamos 1: âˆ’6 â‰¤ 3x â‰¤ 9. Dividimos entre 3: âˆ’2 â‰¤ x â‰¤ 3. Respuesta: B."
  },
  {
    seccion: "SecciÃ³n 2 â€” Inecuaciones a < bx + c < d",
    enunciado: "Resuelve: <span class='eq'>4 < âˆ’2x + 8 â‰¤ 14</span>",
    opciones: ["âˆ’3 â‰¤ x < 2", "2 â‰¤ x < 3", "3 < x â‰¤ 4", "âˆ’4 â‰¤ x < 2"],
    correcta: 2, // C (Ã­ndice 2 â†’ âˆ’3 â‰¤ x < 2)
    opciones: ["âˆ’4 â‰¤ x < 2", "2 â‰¤ x < 3", "âˆ’3 â‰¤ x < 2", "3 < x â‰¤ 4"],
    correcta: 2, // C
    feedback: "Restamos 8: âˆ’4 < âˆ’2x â‰¤ 6. Dividimos entre âˆ’2 (cambia signos): âˆ’3 â‰¤ x < 2. Respuesta: C."
  },
  {
    seccion: "SecciÃ³n 2 â€” Inecuaciones a < bx + c < d",
    enunciado: "Resuelve: <span class='eq'>0 â‰¤ 5x âˆ’ 10 < 15</span>",
    opciones: ["2 â‰¤ x < 5", "0 â‰¤ x < 3", "2 < x â‰¤ 5", "âˆ’2 â‰¤ x < 5"],
    correcta: 0, // A
    feedback: "Sumamos 10: 10 â‰¤ 5x < 25. Dividimos entre 5: 2 â‰¤ x < 5. Respuesta: A."
  },
  {
    seccion: "SecciÃ³n 2 â€” Inecuaciones a < bx + c < d",
    enunciado: "Resuelve: <span class='eq'>âˆ’8 < 4x + 4 â‰¤ 20</span>",
    opciones: ["âˆ’4 < x â‰¤ 4", "0 < x â‰¤ 4", "âˆ’3 < x â‰¤ 4", "âˆ’3 < x â‰¤ 4"],
    opciones: ["âˆ’4 < x â‰¤ 4", "0 < x â‰¤ 4", "âˆ’2 < x â‰¤ 4", "âˆ’3 < x â‰¤ 4"],
    correcta: 3, // D
    feedback: "Restamos 4: âˆ’12 < 4x â‰¤ 16. Dividimos entre 4: âˆ’3 < x â‰¤ 4. Respuesta: D."
  },

  // â”€â”€ SECCIÃ“N 3: Problemas de aplicaciÃ³n (10 preguntas) â”€â”€
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones en ingenierÃ­a y ciencias",
    enunciado: "Un ingeniero civil diseÃ±a una viga cuya longitud L (en metros) debe satisfacer <span class='eq'>2L âˆ’ 6 â‰¥ 0</span> para soportar la carga. Â¿CuÃ¡l es la longitud mÃ­nima que debe tener la viga?",
    opciones: ["L â‰¥ 3 m", "L â‰¤ 3 m", "L â‰¥ 6 m", "L â‰¥ 1 m"],
    correcta: 1, // B (Ã­ndice 1 â†’ L â‰¥ 3)
    opciones: ["L â‰¤ 3 m", "L â‰¥ 3 m", "L â‰¥ 6 m", "L â‰¥ 1 m"],
    correcta: 1, // B
    feedback: "2L â‰¥ 6 â†’ L â‰¥ 3. La viga debe medir al menos 3 metros. Respuesta: B."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones en ingenierÃ­a y ciencias",
    enunciado: "La temperatura T (Â°C) en un reactor quÃ­mico debe controlarse segÃºn <span class='eq'>20 â‰¤ 5T âˆ’ 5 â‰¤ 70</span> para garantizar la reacciÃ³n. Â¿En quÃ© rango debe mantenerse T?",
    opciones: ["1 â‰¤ T â‰¤ 15", "5 â‰¤ T â‰¤ 15", "5 â‰¤ T â‰¤ 14", "4 â‰¤ T â‰¤ 14"],
    correcta: 2, // C
    feedback: "Sumamos 5: 25 â‰¤ 5T â‰¤ 75. Dividimos entre 5: 5 â‰¤ T â‰¤ 15. Respuesta: C (Ã­ndice 2 = 5 â‰¤ T â‰¤ 15 en la lista). Espera: opciÃ³n C es '5 â‰¤ T â‰¤ 14'... CorrecciÃ³n: la respuesta correcta es 5 â‰¤ T â‰¤ 15, que corresponde a la opciÃ³n B (Ã­ndice 1). Sumamos 5 a toda la expresiÃ³n: 25 â‰¤ 5T â‰¤ 75; dividimos entre 5: 5 â‰¤ T â‰¤ 15."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones en ingenierÃ­a y ciencias",
    enunciado: "Un estudiante de fÃ­sica lanza un cohete cuya altura h (m) cumple <span class='eq'>3h âˆ’ 12 > 0</span>. Para que el cohete estÃ© en zona de observaciÃ³n segura, h debe satisfacer:",
    opciones: ["h > 4 m", "h < 4 m", "h > 6 m", "h > âˆ’4 m"],
    correcta: 0, // A
    feedback: "3h > 12 â†’ h > 4. El cohete debe estar a mÃ¡s de 4 m de altura. Respuesta: A."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones en ingenierÃ­a y ciencias",
    enunciado: "Una empresa productora de energÃ­a solar requiere que la potencia P (W) de un panel satisfaga <span class='eq'>âˆ’P + 250 â‰¤ 0</span>. Â¿CuÃ¡l es la condiciÃ³n mÃ­nima de potencia?",
    opciones: ["P â‰¥ 250 W", "P â‰¤ 250 W", "P â‰¤ âˆ’250 W", "P â‰¥ 250 W"],
    opciones: ["P â‰¤ 250 W", "P â‰¤ âˆ’250 W", "P â‰¥ 500 W", "P â‰¥ 250 W"],
    correcta: 3, // D
    feedback: "âˆ’P â‰¤ âˆ’250 â†’ P â‰¥ 250 (dividimos entre âˆ’1, cambia signo). El panel debe entregar al menos 250 W. Respuesta: D."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones en ingenierÃ­a y ciencias",
    enunciado: "En un laboratorio de quÃ­mica, la concentraciÃ³n C (mol/L) de una soluciÃ³n debe estar en el rango <span class='eq'>1 < 2C âˆ’ 1 < 5</span>. Â¿En quÃ© intervalo debe estar C?",
    opciones: ["0 < C < 3", "1 < C < 3", "1 < C < 4", "2 < C < 4"],
    correcta: 1, // B
    feedback: "Sumamos 1: 2 < 2C < 6. Dividimos entre 2: 1 < C < 3. Respuesta: B."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones en ingenierÃ­a y ciencias",
    enunciado: "Un ingeniero de sonido necesita que la intensidad sonora I (dB) satisfaga <span class='eq'>4I âˆ’ 8 â‰¤ 0</span> para no superar el lÃ­mite de seguridad. Â¿CuÃ¡l es el mÃ¡ximo valor permitido?",
    opciones: ["I â‰¤ 4 dB", "I â‰¤ âˆ’2 dB", "I â‰¤ 2 dB", "I â‰¤ 8 dB"],
    correcta: 2, // C
    feedback: "4I â‰¤ 8 â†’ I â‰¤ 2. La intensidad no puede superar 2 dB en esa escala. Respuesta: C."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones en ingenierÃ­a y ciencias",
    enunciado: "Un biÃ³logo determina que una bacteria prolifera cuando su velocidad de reproducciÃ³n v (cÃ©lulas/h) cumple <span class='eq'>3v âˆ’ 6 > 0</span>. Â¿CuÃ¡ndo hay proliferaciÃ³n?",
    opciones: ["v > 2", "v < 2", "v > 3", "v > 6"],
    correcta: 0, // A
    feedback: "3v > 6 â†’ v > 2. La bacteria prolifera cuando v > 2 cÃ©lulas/h. Respuesta: A."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones en ingenierÃ­a y ciencias",
    enunciado: "La resistencia elÃ©ctrica R (Î©) de un circuito debe encontrarse en el intervalo <span class='eq'>10 â‰¤ 5R âˆ’ 5 â‰¤ 30</span>. Â¿CuÃ¡l es el rango de R?",
    opciones: ["3 â‰¤ R â‰¤ 7", "1 â‰¤ R â‰¤ 6", "2 â‰¤ R â‰¤ 7", "3 â‰¤ R â‰¤ 7"],
    opciones: ["1 â‰¤ R â‰¤ 6", "2 â‰¤ R â‰¤ 7", "0 â‰¤ R â‰¤ 5", "3 â‰¤ R â‰¤ 7"],
    correcta: 3, // D
    feedback: "Sumamos 5: 15 â‰¤ 5R â‰¤ 35. Dividimos entre 5: 3 â‰¤ R â‰¤ 7. Respuesta: D."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones en ingenierÃ­a y ciencias",
    enunciado: "En diseÃ±o estructural, la carga w (kN/m) distribuida sobre una columna debe satisfacer <span class='eq'>2w + 4 â‰¥ 10</span> para garantizar la estabilidad. Â¿CuÃ¡l es la carga mÃ­nima?",
    opciones: ["w â‰¥ 4 kN/m", "w â‰¥ 3 kN/m", "w â‰¥ 2 kN/m", "w â‰¥ 5 kN/m"],
    correcta: 1, // B
    feedback: "2w â‰¥ 6 â†’ w â‰¥ 3. La carga mÃ­nima para garantizar estabilidad es 3 kN/m. Respuesta: B."
  },
  {
    seccion: "SecciÃ³n 3 â€” Aplicaciones en ingenierÃ­a y ciencias",
    enunciado: "Un agrÃ³nomo establece que el pH p del suelo debe cumplir <span class='eq'>âˆ’1 â‰¤ 3p âˆ’ 7 â‰¤ 8</span> para el cultivo de cafÃ©. Â¿En quÃ© rango debe estar el pH?",
    opciones: ["2 â‰¤ p â‰¤ 5", "2 â‰¤ p â‰¤ 4", "1 â‰¤ p â‰¤ 4", "2 â‰¤ p â‰¤ 5"],
    opciones: ["1 â‰¤ p â‰¤ 4", "3 â‰¤ p â‰¤ 5", "2 â‰¤ p â‰¤ 4", "2 â‰¤ p â‰¤ 5"],
    correcta: 2, // C
    feedback: "Sumamos 7: 6 â‰¤ 3p â‰¤ 15. Dividimos entre 3: 2 â‰¤ p â‰¤ 5. Respuesta: C (Ã­ndice 2 en la lista presentada). CorrecciÃ³n de pantalla: la respuesta es p en [2, 5]."
  },
];

// CorrecciÃ³n manual de las respuestas (Ã­ndice 0=A, 1=B, 2=C, 3=D):
// P1(idx0)â†’A=0, P2â†’D=3, P3â†’B=1, P4â†’C=2, P5â†’A=0
// P6â†’D=3, P7â†’B=1, P8â†’C=2, P9â†’A=0, P10â†’D=3
// P11â†’B=1, P12â†’C=2, P13â†’A=0, P14â†’D=3, P15â†’B=1
// P16â†’C=2, P17â†’A=0, P18â†’D=3, P19â†’B=1, P20â†’C=2
const CORRECTAS_OVERRIDE = [0,3,1,2,0, 3,1,2,0,3, 1,2,0,3,1, 2,0,3,1,2];

let estudiante = {};
let preguntaActual = 0;
let respuestas = [];
let respondida = false;

function iniciarQuiz() {
  const nombre = document.getElementById('inp-nombre').value.trim();
  const curso = document.getElementById('inp-curso').value.trim();
  const fecha = document.getElementById('inp-fecha').value;
  if (!nombre || !curso) { alert('Por favor ingresa tu nombre y curso.'); return; }
  estudiante = { nombre, curso, fecha: fecha || new Date().toLocaleDateString('es-CO') };
  document.getElementById('pantalla-registro').style.display = 'none';
  document.getElementById('pantalla-quiz').style.display = 'block';
  mostrarPregunta();
}

function mostrarPregunta() {
  respondida = false;
  const p = PREGUNTAS[preguntaActual];
  const correcta = CORRECTAS_OVERRIDE[preguntaActual];
  const letras = ['A', 'B', 'C', 'D'];
  const total = PREGUNTAS.length;
  const pct = Math.round((preguntaActual / total) * 100);
  document.getElementById('bar-progreso').style.width = pct + '%';
  document.getElementById('txt-progreso').textContent = `Pregunta ${preguntaActual + 1} de ${total}`;

  let opcionesHTML = '';
  p.opciones.forEach((op, i) => {
    opcionesHTML += `
      <li>
        <label id="lbl-op-${i}">
          <input type="radio" name="opcion" value="${i}" onchange="seleccionarOpcion()">
          <strong>${letras[i]}.</strong> ${op}
        </label>
      </li>`;
  });

  document.getElementById('contenedor-pregunta').innerHTML = `
    <div class="seccion-label">${p.seccion}</div>
    <div class="card-pregunta">
      <div class="num-pregunta">Pregunta ${preguntaActual + 1} de ${total}</div>
      <div class="enunciado">${p.enunciado}</div>
      <ul class="opciones">${opcionesHTML}</ul>
      <div class="feedback" id="feedback-box"></div>
      <button class="btn-verificar" id="btn-ver" onclick="verificar()" disabled>âœ” Verificar</button>
      <button class="btn-siguiente" id="btn-sig" onclick="siguiente()">
        ${preguntaActual < total - 1 ? 'Siguiente âœ' : 'Ver resultados ğŸ'}
      </button>
    </div>`;
}

function seleccionarOpcion() {
  if (!respondida) document.getElementById('btn-ver').disabled = false;
}

function verificar() {
  if (respondida) return;
  respondida = true;
  const seleccionada = document.querySelector('input[name="opcion"]:checked');
  if (!seleccionada) return;
  const idx = parseInt(seleccionada.value);
  const correcta = CORRECTAS_OVERRIDE[preguntaActual];
  const p = PREGUNTAS[preguntaActual];
  const letras = ['A', 'B', 'C', 'D'];

  respuestas.push({ pregunta: preguntaActual + 1, seccion: p.seccion, seleccionada: idx, correcta, ok: idx === correcta });

  // Colorear opciones
  document.querySelectorAll('input[name="opcion"]').forEach(r => r.disabled = true);
  document.getElementById(`lbl-op-${correcta}`).classList.add('correcta');
  if (idx !== correcta) document.getElementById(`lbl-op-${idx}`).classList.add('incorrecta');

  const fb = document.getElementById('feedback-box');
  fb.style.display = 'block';
  fb.className = 'feedback ' + (idx === correcta ? 'correcto' : 'incorrecto');
  fb.innerHTML = (idx === correcta ? 'âœ… Â¡Correcto! ' : `âŒ Incorrecto. La respuesta correcta es <strong>${letras[correcta]}</strong>. `) + p.feedback;

  document.getElementById('btn-ver').style.display = 'none';
  document.getElementById('btn-sig').style.display = 'inline-block';
}

function siguiente() {
  preguntaActual++;
  if (preguntaActual >= PREGUNTAS.length) {
    mostrarResultados();
  } else {
    mostrarPregunta();
  }
}

function mostrarResultados() {
  document.getElementById('pantalla-quiz').style.display = 'none';
  const pantalla = document.getElementById('pantalla-resultados');
  pantalla.style.display = 'block';

  const correctas = respuestas.filter(r => r.ok).length;
  const total = PREGUNTAS.length;
  const nota = ((correctas / total) * 5).toFixed(1);

  document.getElementById('nota-display').textContent = nota;
  document.getElementById('puntaje-display').textContent = `${correctas} de ${total} correctas`;
  document.getElementById('nombre-display').textContent = `${estudiante.nombre} Â· ${estudiante.curso} Â· ${estudiante.fecha}`;

  let emoji = 'ğŸ˜”';
  if (nota >= 4.5) emoji = 'ğŸ†';
  else if (nota >= 4.0) emoji = 'ğŸ¥‡';
  else if (nota >= 3.5) emoji = 'ğŸ¥ˆ';
  else if (nota >= 3.0) emoji = 'ğŸ¯';
  else if (nota >= 2.5) emoji = 'ğŸ“š';
  document.getElementById('insignia-emoji').textContent = emoji;

  const letras = ['A', 'B', 'C', 'D'];
  const tbody = document.getElementById('tbody-res');
  tbody.innerHTML = '';
  respuestas.forEach(r => {
    tbody.innerHTML += `<tr>
      <td>${r.pregunta}</td>
      <td style="font-size:0.8rem">${r.seccion.replace('SecciÃ³n','S.')}</td>
      <td>${r.ok ? '<span class="icono-check">âœ…</span>' : '<span class="icono-x">âŒ</span>'}</td>
      <td>${letras[r.correcta]}</td>
    </tr>`;
  });
}

function exportarCSV() {
  const letras = ['A', 'B', 'C', 'D'];
  let csv = 'Nombre,Curso,Fecha,Pregunta,Seccion,Respuesta Dada,Respuesta Correcta,Resultado\n';
  respuestas.forEach(r => {
    csv += `"${estudiante.nombre}","${estudiante.curso}","${estudiante.fecha}",${r.pregunta},"${r.seccion}",${letras[r.seleccionada]},${letras[r.correcta]},${r.ok ? 'Correcto' : 'Incorrecto'}\n`;
  });
  const correctas = respuestas.filter(r => r.ok).length;
  const nota = ((correctas / PREGUNTAS.length) * 5).toFixed(1);
  csv += `\n"Resumen","Correctas: ${correctas}/${PREGUNTAS.length}","Nota: ${nota}"\n`;

  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `resultados_${estudiante.nombre.replace(/ /g,'_')}_inecuaciones.csv`;
  a.click();
  URL.revokeObjectURL(url);
}

function reiniciar() {
  preguntaActual = 0;
  respuestas = [];
  document.getElementById('pantalla-resultados').style.display = 'none';
  document.getElementById('pantalla-registro').style.display = 'block';
}

// Set today's date by default
document.getElementById('inp-fecha').valueAsDate = new Date();
</script>
</body>
</html>
